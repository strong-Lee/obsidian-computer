### 1. 核心概念理解
- **工作流 (Workflow):** 就是你要搭建的整个自动化流程图。
    
- **节点 (Node):** 流程图中的每一个方块，代表一个操作步骤。
    
- **触发器 (Trigger):** 每个工作流的**第一个节点**，负责启动整个流程。它通常是紫色的，带有一个闪电标志⚡。例如“当收到一个表单提交时”、“每小时定时执行一次”。
    
- **操作 (Action):** 触发器之后的所有节点，负责执行具体任务，比如发送邮件、读写数据库、调用 API 等。
    
- **数据项 (Item):** n8n 中数据流转的基本单位。一个节点执行完后，会输出一个或多个数据项给下一个节点使用。你可以把它想象成一个 JSON 对象。
    
- **画布 (Canvas):** 你拖拽和连接节点的那个大大的网格区域。
    
- **固定数据 (Pin Data):** 一个非常强大的调试功能。你可以把某次测试运行的输出数据“钉”在节点上，这样后续开发时，即使你修改了其他节点，这个节点的输出数据也不会变，方便你稳定地调试后面的流程。

### 2. 搭建工作流：从零开始

#### 步骤一：创建第一个节点 - 表单触发器

1. **新建工作流：** 在 n8n 主界面，点击 "Start from scratch" (从头开始) 创建一个空白的工作流。
    
2. **添加第一个节点：** 在画布中央点击 + (Add first step...)。
    
3. **选择触发器：** 在弹出的节点选择器中，我们要找一个能接收网页表单提交的触发器。在列表中选择 **"On form submission" (当表单被提交时)**。
    
4. **配置表单节点：**
    
    - **Form Title (表单标题):** 输入 "Request an installation" (请求安装)。
        
    - **Form Description (表单描述):** 输入 "Fill out this form to request an installation. We'll reach out via email to finalize your appointment." (填写此表单以请求安装。我们将通过邮件与您联系以最终确定您的预约。)
        
    - **Add Form Element (添加表单元素):** 我们需要两个输入框。
        
        - **第一个元素：**
            
            - 点击 "Add Form Element"。
                
            - **Field Name (字段名):** Email Address (邮箱地址)。
                
            - **Element Type (元素类型):** 选择 Email (这会自动进行邮箱格式验证)。
                
            - **Required Field (必填字段):** 打开开关，设为必填。
                
        - **第二个元素：**
            
            - 再次点击 "Add Form Element"。
                
            - **Field Name (字段名):** Preferred install date (期望安装日期)。
                
            - **Element Type (元素类型):** 选择 Date (日期)，这样用户会看到一个方便的日历选择器。
                
            - **Required Field (必填字段):** 同样设为必填。

#### 步骤二：测试触发器并固定数据

1. **执行测试：** 点击节点右上角的 **"Execute step" (执行步骤)** 按钮。
    
2. **填写测试表单：** n8n 会弹出一个测试用的表单网页。
    
    - 在 "Email Address" 中输入一个测试邮箱，如 name@email.com。
        
    - 在 "Preferred install date" 中选择一个**两天后**的日期，比如 2025-06-19。
        
    - 点击 "Submit"。
        
3. **查看输出数据：** 切换回 n8n 界面，你会看到右侧的 **OUTPUT (输出)** 面板中出现了数据。
    
    - 数据以 **JSON** 格式显示，包含了你刚才提交的邮箱、日期等信息。这证明触发器工作正常！
        
    - 你也可以切换到 **Table(表格)** 或 **Schema(结构)** 视图来查看数据。
        
4. **固定数据 (Pin Data):** 这是个非常有用的技巧！为了方便后续调试，我们不希望每次都重新提交表单。
    
    - 在 **OUTPUT** 面板的右上角，找到那个**图钉📌图标**，点击它。
        
    - 图钉变成紫色，表示数据已固定。现在，无论你怎么执行工作流，这个节点的输出都会是我们刚刚测试的这条数据。
	
#### 步骤三：添加条件判断节点 (IF) 

1. **添加新节点：** 点击“表单”节点右侧的 + 号。
    
2. **选择 IF 节点：** 在节点选择器中，找到 **Flow (流控制)** 分类，选择 **"If"** 节点。
    
3. **配置 IF 节点的条件：** 我们的目标是判断 Preferred install date 是否在从今天起的7天之内。
    
    - 在 "Conditions" (条件) 部分，有两个值需要设置。
        
    - **Value 1 (值1):** 这是我们要检查的数据。点击输入框，左侧的 **INPUT** 面板会显示上一个节点的输出。找到 Preferred install date，**直接从左边把它拖拽到 Value 1 的输入框里**。它会自动变成一个表达式：{{ $json['Preferred install date'] }}。
        
        - 为了更严谨，视频中还加了一个 .toDateTime() 方法，把它显式地转换成日期时间对象：{{ $json['Preferred install date'].toDateTime() }}。
            
    - **Operator (运算符):** 我们要判断日期是否“早于或等于”某个时间点。在下拉菜单中，找到 **Date & Time** 分类，选择 **"is before or equal to" (早于或等于)**。
        
    - **Value 2 (值2):** 这是我们要比较的目标，即“7天后的现在”。这里需要用表达式。
        
        - 点击输入框右侧的 "fx" 切换到表达式模式。
            
        - 输入 {{ $now.plus(7, 'days') }}。
            
            - $now: n8n 内置的变量，代表当前时间。
                
            - .plus(7, 'days'): 在当前时间的基础上，增加7天。
                
4. **测试 IF 节点：** 点击 "Execute step"。因为我们固定的日期是2天后，小于7天，所以数据会从 **True (真)** 分支出去。你可以看到 "True Branch" 下面有 1 个 item。

#### 步骤四：配置 True 分支 - 发送 Slack 通知 

1. **添加 Slack 节点：** 点击 IF 节点 **True** 分支右侧的 + 号。
    
2. **搜索并选择 Slack 节点, 选择 “Send a message”。**
    
3. **连接 Slack 账户：**
    
    - 在 "Credential to connect" (连接凭证) 中，点击 "Create new credential" (创建新凭证)。
        
    - n8n 会引导你完成 OAuth2 授权流程，登录你的 Slack 账户并授权。这一步通常非常顺利。

	- 可以参照 [[获取Slack的客户端ID和密钥]]
        
4. **配置 Slack 消息：**
    
    - **Channel (频道):** 选择 sales 频道。
        
    - **Message Text (消息文本):** 这里我们要把表单里的动态数据和静态文本结合起来。
        
        - 点击输入框右侧的 "fx" 切换到表达式模式。
            
        - 输入以下文本，并像之前一样，从左侧的 **INPUT** 面板中**拖拽**相应的数据到正确的位置：
            
        ```
        New install request (within 7 days).
        Contact email: {{ $json['Email Address'] }}
        Preferred install date: {{ $json['Preferred install date'] }}
        ```

		- 由于是局域网安装，直接授权会报错，可以参考 [[ 使用 ngrok 完成 Slack 授权]]
        
5. **测试 Slack 节点：** 点击 "Execute step"。你会看到 Slack 的 #sales 频道里收到了一条格式化的通知！

#### 步骤五：配置 False 分支 - 添加待办事项 (09:35 - 09:54)

1. **添加 No Operation 节点：** 点击 IF 节点 **False** 分支右侧的 + 号。
    
2. 搜索并选择 **"No Operation" (无操作)** 节点。
    
3. **重命名节点：** 这个节点本身什么也不做，但我们可以重命名它来作为备注。点击节点左上角的标题，把它改成 todo。这样我们就知道，如果安装日期在7天之后，流程会走到这里，提醒我们以后可能要在这里添加一些处理逻辑（比如存到数据库）。

#### 步骤六：保存并激活工作流 (12:36 - 13:38)

1. **保存 (Save):** 点击画布右上角的红色 **"Save" (保存)** 按钮。
    
2. **激活 (Activate):** 点击左上角的 **"Inactive" (未激活)** 开关，把它变成 **"Active" (已激活)**。
    

**恭喜！** 你的工作流现在已经正式上线运行了。你可以通过访问“表单”节点参数里的 **Production URL (生产环境URL)**，让真实的用户来提交表单，整个流程就会自动运行起来了！

你可以在 **Executions (执行记录)** 标签页看到每一次真实运行的历史记录，方便你追踪和调试。