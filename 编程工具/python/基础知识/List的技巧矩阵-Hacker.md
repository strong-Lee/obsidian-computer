#### 1. ğŸ´â€â˜ ï¸ é»‘å®¢ï¼šå°æ•´æ•°ç¼“å­˜ (Small Integer Cache)

**åœºæ™¯**ï¼šåˆ—è¡¨é‡Œå­˜äº†å¾ˆå¤šå°æ•°å­—ã€‚
```python
# åŠ¨ä½œï¼šåˆ›å»ºä¸¤ä¸ªçœ‹èµ·æ¥ä¸€æ ·çš„åˆ—è¡¨
a = [1, 2, 3]
b = [1, 2, 3]

# åˆ¤å®šï¼šå®ƒä»¬å†…éƒ¨çš„æŒ‡é’ˆæŒ‡å‘çš„æ˜¯åŒä¸€ä¸ªå¯¹è±¡å—ï¼Ÿ
print(a[0] is b[0])  # True!

# ğŸ’¡ æºç çº§å‰–æ (Source Code Analysis)
# --------------------------------------------------------------------
# 1. CPython ä¼˜åŒ–ï¼š
#    - æ•´æ•° -5 åˆ° 256 æ˜¯é¢„å…ˆåˆ›å»ºå¥½çš„å•ä¾‹å¯¹è±¡ (Global Array)ã€‚
#    - å½“ä½ å†™ `a = [1]` æ—¶ï¼Œåˆ—è¡¨é‡Œå­˜çš„æ˜¯é‚£ä¸ªå…¨å±€å”¯ä¸€çš„ `1` å¯¹è±¡çš„åœ°å€ã€‚
#    - è¿™æå¤§åœ°èŠ‚çœäº†å†…å­˜ã€‚
#
# 2. è­¦ç¤ºï¼š
#    - å¦‚æœå­˜çš„æ˜¯ `a = [1000]`, `b = [1000]`ï¼Œåˆ™ `a[0] is b[0]` é€šå¸¸æ˜¯ Falseï¼ˆé™¤éè§¦å‘äº†ç¼–è¯‘å™¨çš„å¸¸é‡æŠ˜å ï¼‰ã€‚
```

#### 2. ğŸ´â€â˜ ï¸ é»‘å®¢ï¼šåˆ—è¡¨çš„çº¿ç¨‹å®‰å…¨æ€§ (Thread Safety & GIL)

**åœºæ™¯**ï¼šå¤šçº¿ç¨‹åŒæ—¶æ“ä½œä¸€ä¸ªå…¨å±€åˆ—è¡¨ã€‚  
**PHPæ€ç»´**ï¼šPHP ä¸»è¦æ˜¯å¤šè¿›ç¨‹æ¨¡å‹ï¼Œå¾ˆå°‘æ¶‰åŠå¤šçº¿ç¨‹å…±äº«å†…å­˜ã€‚
```python
import threading
data = []

def worker():
    data.append(1)

# ğŸ’¡ æºç çº§å‰–æ (Source Code Analysis)
# --------------------------------------------------------------------
# 1. åŸå­æ“ä½œ (Atomic Operations):
#    - ç”±äº GIL (Global Interpreter Lock) çš„å­˜åœ¨ï¼ŒPython å­—èŠ‚ç åœ¨åŒä¸€æ—¶åˆ»åªèƒ½è¢«ä¸€ä¸ªçº¿ç¨‹æ‰§è¡Œã€‚
#    - `append()`, `pop()`, `sort()`, `extend()` éƒ½æ˜¯åŸå­æ“ä½œã€‚
#    - å®ƒä»¬åœ¨ C è¯­è¨€å±‚é¢æ‰§è¡Œæ—¶ä¸ä¼šé‡Šæ”¾ GILï¼Œä¹Ÿä¸ä¼šè¢«ä¸­æ–­ã€‚
#
# 2. éåŸå­æ“ä½œ (Non-Atomic):
#    - `data[i] = data[i] + 1` ä¸æ˜¯åŸå­çš„ï¼
#      å› ä¸ºå®ƒåˆ†ä¸ºä¸‰æ­¥ï¼šè¯»ã€åŠ ã€å†™ã€‚ä¸­é—´å¯èƒ½å‘ç”Ÿçº¿ç¨‹åˆ‡æ¢ã€‚
#    - `if len(data) > 0: val = data.pop()` è¿™ä¸€æ•´å—é€»è¾‘ä¸æ˜¯åŸå­çš„ã€‚åˆ¤ç©ºåå¯èƒ½è¢«åˆ«çš„çº¿ç¨‹æŠ¢å…ˆ pop ç©ºäº†ã€‚
#
# 3. æ¶æ„å»ºè®®ï¼š
#    - å•ä¸ª list æ–¹æ³•è°ƒç”¨æ˜¯å®‰å…¨çš„ã€‚
#    - ç»„åˆé€»è¾‘å¿…é¡»åŠ é” (`threading.Lock`)ã€‚
```

#### 3. âš¡ æé€Ÿï¼šæˆå‘˜æ£€æŸ¥çš„ä¼˜åŒ– (Set Optimization)

**åœºæ™¯**ï¼šä½ éœ€è¦è¿‡æ»¤åˆ—è¡¨ï¼Œè¿‡æ»¤æ¡ä»¶æ˜¯â€œåœ¨å¦ä¸€ä¸ªåˆ—è¡¨é‡Œâ€ã€‚
```python
# âŒ æ…¢
# forbidden = ["admin", "root", "system"] ... (å‡è®¾æœ‰1000ä¸ª)
# users = ["user1", "root", "user2"]
# valid = [u for u in users if u not in forbidden] # O(M * N)

# ğŸš€ æ¨è (Fast/Pythonic)
forbidden_set = {"admin", "root", "system"} # O(1) æŸ¥æ‰¾
valid = [u for u in users if u not in forbidden_set] # O(M)

# ğŸ’¡ æºç çº§å‰–æ (Source Code Analysis)
# --------------------------------------------------------------------
# 1. æŒ‡ä»¤å·®å¼‚ï¼š
#    - `u not in forbidden` (List): è°ƒç”¨ `PySequence_Contains` -> çº¿æ€§æ‰«æã€‚
#    - `u not in forbidden_set` (Set): è°ƒç”¨ `set_contains` -> å“ˆå¸ŒæŸ¥æ‰¾ã€‚
#    - æ€§èƒ½å·®è·å¯ä»¥æ˜¯ 1000å€ç”šè‡³æ›´å¤šã€‚
```

####   4. ğŸ´â€â˜ ï¸ é»‘å®¢ï¼š__slots__Â èŠ‚çœå†…å­˜

**åœºæ™¯**ï¼šå¦‚æœä½ è¦å­˜ 100 ä¸‡ä¸ªè‡ªå®šä¹‰å¯¹è±¡åˆ°åˆ—è¡¨é‡Œã€‚  
**PHPæ€ç»´**ï¼šå¯¹è±¡å°±æ˜¯æ•°ç»„ï¼Œå†…å­˜å¼€é”€å¤§ã€‚
```python
class Point:
    __slots__ = ['x', 'y'] # ç¦æ­¢åˆ›å»º __dict__
    def __init__(self, x, y):
        self.x = x
        self.y = y

points = [Point(i, i) for i in range(1000000)]

# ğŸ’¡ æºç çº§å‰–æ (Source Code Analysis)
# --------------------------------------------------------------------
# 1. å†…å­˜æ¨¡å‹ï¼š
#    - æ™®é€š Python å¯¹è±¡æœ‰ä¸€ä¸ª `__dict__` (å“ˆå¸Œè¡¨) æ¥å­˜å±æ€§ï¼Œæå…¶æµªè´¹å†…å­˜ã€‚
#    - å®šä¹‰ `__slots__` åï¼ŒCPython ç›´æ¥åœ¨ç»“æ„ä½“é‡Œåˆ†é…å›ºå®šçš„ç©ºé—´å­˜ `x` å’Œ `y` çš„æŒ‡é’ˆã€‚
#    - å†…å­˜å ç”¨å¯ä»¥å‡å°‘ 40% ~ 50%ã€‚
#    - è¿™å¯¹å¤§è§„æ¨¡åˆ—è¡¨å­˜å‚¨å¯¹è±¡è‡³å…³é‡è¦ã€‚
```

#### 5. ğŸ´â€â˜ ï¸ é»‘å®¢ï¼šList çš„æ‰©å®¹å…¬å¼ (The Growth Pattern)

**åœºæ™¯**ï¼šä½œä¸ºæ¶æ„å¸ˆï¼Œä½ å¿…é¡»ç²¾ç¡®é¢„ä¼°å†…å­˜å¢é•¿ï¼Œé˜²æ­¢ OOMã€‚  
**PHPæ€ç»´**ï¼šé€šå¸¸æ˜¯ 2 å€æ‰©å®¹ (Doubling)ã€‚
```python
# CPython (3.7+) çš„æ‰©å®¹ç­–ç•¥æºç é€»è¾‘ï¼š
# å½“éœ€è¦æ‰©å®¹æ—¶ (new_size > allocated):

# new_allocated = new_size + (new_size >> 3) + 6
# å¢é•¿å› å­çº¦ä¸º 1.125 (12.5%) + å°å¸¸æ•°

# ç¤ºä¾‹åºåˆ—ï¼š
# [] (0) -> append -> (åˆ†é… 4)
# [1, 2, 3, 4] -> append -> (éœ€è¦ 5ï¼Œåˆ†é… 5 + 0 + 6 = 11? ä¸å®Œå…¨æ˜¯ï¼Œæœ‰å¯¹é½æœºåˆ¶)
# å®é™…åºåˆ—å¤§è‡´ä¸ºï¼š0, 4, 8, 16, 25, 35, 46, 58, 72, 88 ...

# ğŸ’¡ æºç çº§å‰–æ (Source Code Analysis)
# --------------------------------------------------------------------
# 1. ä¸ºä»€ä¹ˆä¸æ˜¯ 2 å€ï¼Ÿ
#    - å¦‚æœæ€»æ˜¯ 2 å€ï¼Œå†…å­˜æµªè´¹å¯èƒ½é«˜è¾¾ 50%ã€‚
#    - 12.5% çš„æ¸©å’Œå¢é•¿ï¼Œè®©å†…å­˜åˆ©ç”¨ç‡æ›´ç´§å‡‘ï¼Œé€‚åˆç°ä»£å¤§å†…å­˜ç¯å¢ƒã€‚
#    - é‚£ä¸ª `+6` æ˜¯ä¸ºäº†ç…§é¡¾å°åˆ—è¡¨ï¼Œé˜²æ­¢åˆšå¼€å§‹é¢‘ç¹æ‰©å®¹ï¼ˆä» 0 åˆ° 1 æ—¶ï¼Œç›´æ¥ç»™ä¸€å¸­ä¹‹åœ°å¤ªå°æ°”ï¼‰ã€‚
#
# 2. æ¶æ„å¯ç¤ºï¼š
#    - å¦‚æœä½ è¦å­˜ 1 äº¿ä¸ªå¯¹è±¡ï¼Œä¸è¦ä¸€ä¸ªä¸€ä¸ª appendã€‚
#    - è™½ç„¶æ‘Šè¿˜ O(1)ï¼Œä½†è¿™ä¼šå¯¼è‡´å‡ åæ¬¡å·¨å¤§çš„ `realloc` å’Œ `memmove`ã€‚
#    - åŠ¡å¿…ä½¿ç”¨ `[None] * N` ä¸€æ¬¡æ€§åˆ†é…åˆ°ä½ã€‚
```

#### 6. ğŸ’€ æ€§èƒ½æ€æ‰‹ï¼šå¾ªç¯å¼•ç”¨çš„åƒåœ¾å›æ”¶ (GC Cycles)

**åœºæ™¯**ï¼šä¸¤ä¸ªåˆ—è¡¨äº’ç›¸å¼•ç”¨ï¼Œç„¶ååˆ é™¤å˜é‡ã€‚  
**PHPæ€ç»´**ï¼šPHP 5.3 å¼•å…¥äº†å¾ªç¯å¼•ç”¨ GCã€‚åœ¨æ­¤ä¹‹å‰ï¼Œè¿™æ˜¯å†…å­˜æ³„æ¼çš„æºå¤´ã€‚
```python
import gc

a = []
b = []
a.append(b)
b.append(a)

del a
del b
# æ­¤æ—¶ï¼Œä¸¤ä¸ªåˆ—è¡¨å¯¹è±¡çš„å¼•ç”¨è®¡æ•°éƒ½æ˜¯ 1 (å½¼æ­¤æŒ‡ç€)ï¼Œä¸ä¼šå½’é›¶ã€‚

# ğŸš€ æ¨è (Fast/Pythonic) - æ‰‹åŠ¨è§¦å‘ï¼ˆæç«¯æƒ…å†µï¼‰
# gc.collect() 

# ğŸ’¡ æºç çº§å‰–æ (Source Code Analysis)
# --------------------------------------------------------------------
# 1. å¼•ç”¨è®¡æ•° (Ref Counting) vs æ ‡è®°æ¸…é™¤ (Mark & Sweep):
#    - Python ä¸»åŠ›æ˜¯å¼•ç”¨è®¡æ•°ã€‚ä¸€æ—¦å½’é›¶ï¼Œç«‹å³å›æ”¶ã€‚
#    - å¯¹äºå¾ªç¯å¼•ç”¨ï¼ŒPython æœ‰ä¸€ä¸ª**åˆ†ä»£åƒåœ¾å›æ”¶å™¨ (Generational GC)**ã€‚
#    - å®ƒä¼šå®šæœŸæš‚åœç¨‹åºï¼Œæ‰«ææ‰€æœ‰å®¹å™¨å¯¹è±¡ (List, Dict, Class)ï¼Œå¯»æ‰¾ä¸å¯è¾¾çš„ç¯ã€‚
#
# 2. æ€§èƒ½å‘ï¼š
#    - åˆ—è¡¨æ˜¯å¯ä»¥è¿½è¸ªçš„ (Tracked) å¯¹è±¡ã€‚
#    - å¦‚æœä½ åˆ›å»ºäº†æ•°ç™¾ä¸‡ä¸ªäº’ç›¸å¼•ç”¨çš„å°å¯¹è±¡ï¼ŒGC æ‰«æçš„å¼€é”€ä¼šéå¸¸å¤§ã€‚
#    - è°ƒä¼˜æ‰‹æ®µï¼š`gc.disable()` æˆ–è€…å‡å°‘å¾ªç¯å¼•ç”¨ã€‚
```

#### 7. ğŸš€ è¿›é˜¶ï¼šæ’åºç¨³å®šæ€§ (Stable Sort)

**åœºæ™¯**ï¼šå¤šçº§æ’åºã€‚å…ˆæŒ‰å¹´é¾„æ’ï¼Œå†æŒ‰åå­—æ’ã€‚  
**PHPæ€ç»´**ï¼šæ—©æœŸçš„Â usortÂ ä¸ç¨³å®šï¼ŒPHP 7+ ååŸºæœ¬ç¨³å®šäº†ã€‚
```python
data = [("Bob", 20), ("Alice", 20), ("Charlie", 18)]

# åŠ¨ä½œï¼šå…ˆæŒ‰åå­—æ’
data.sort(key=lambda x: x[0])
# å†æŒ‰å¹´é¾„æ’
data.sort(key=lambda x: x[1])

# ç»“æœï¼šCharlie(18), Alice(20), Bob(20)
# æ³¨æ„ï¼šAlice å’Œ Bob çš„ç›¸å¯¹é¡ºåºï¼ˆæŒ‰åå­—æ’çš„ï¼‰è¢«ä¿ç•™äº†ï¼

# ğŸ’¡ æºç çº§å‰–æ (Source Code Analysis)
# --------------------------------------------------------------------
# 1. Timsort çš„ä¿è¯ï¼š
#    - Timsort ä¸¥æ ¼ä¿è¯ç¨³å®šæ€§ (Stability)ã€‚
#    - å½“æ¯”è¾ƒä¸¤ä¸ªå…ƒç´ â€œç›¸ç­‰â€æ—¶ï¼Œå®ƒç»å¯¹ä¸ä¼šäº¤æ¢å®ƒä»¬çš„ä½ç½®ã€‚
#    - è¿™å…è®¸ä½ é€šè¿‡å¤šæ¬¡ sort å®ç° SQL ä¸­çš„ `ORDER BY age, name` æ•ˆæœã€‚
```

#### 8. âš¡ æé€Ÿï¼šåˆ©ç”¨Â disÂ éªŒè¯ä½ çš„çŒœæƒ³ (Disassembly)

**åœºæ™¯**ï¼šä½ ä¸ç›¸ä¿¡æˆ‘è¯´çš„Â []Â æ¯”Â list()Â å¿«ï¼Œæˆ–è€…æƒ³çœ‹æ¨å¯¼å¼åˆ°åº•å¹²äº†å•¥ã€‚  
**PHPæ€ç»´**ï¼šåˆ©ç”¨ VLD (Vulcan Logic Dumper) æŸ¥çœ‹ PHP Opcodeã€‚
```python
import dis

def test_literal():
    a = []

def test_func():
    a = list()

# ğŸ´â€â˜ ï¸ é»‘å®¢ (Hacker Tool)
dis.dis(test_literal)
# 0 BUILD_LIST  0  (ç›´æ¥æŒ‡ä»¤)
# 2 STORE_FAST  0 (a)

dis.dis(test_func)
# 0 LOAD_GLOBAL 0 (list) (æŸ¥æ‰¾å…¨å±€å˜é‡)
# 2 CALL_FUNCTION 0 (å‡½æ•°è°ƒç”¨å¼€é”€)
# 4 STORE_FAST  0 (a)

# ğŸ’¡ æºç çº§å‰–æ (Source Code Analysis)
# --------------------------------------------------------------------
# 1. æ¶æ„å¸ˆçš„æ˜¾å¾®é•œï¼š
#    - å½“ä½ åœ¨ä¸ºäº†å‡ å¾®ç§’äº‰è®ºä¸ä¼‘æ—¶ï¼Œç›´æ¥ `dis` çœ‹æŒ‡ä»¤æ•°ã€‚
#    - Python è™šæ‹Ÿæœºæ˜¯åŸºäºæ ˆçš„ (Stack Based)ï¼ŒæŒ‡ä»¤è¶Šå°‘ï¼Œé€šå¸¸è¶Šå¿«ã€‚
```

#### 9. ğŸš€ è¿›é˜¶ï¼šè·¨è¿›ç¨‹å…±äº«åˆ—è¡¨ (Shared Memory)

**åœºæ™¯**ï¼šåˆ©ç”¨å¤šæ ¸ CPU å¤„ç†å¤§åˆ—è¡¨ï¼ˆå› ä¸º GIL é”ä½äº†å¤šçº¿ç¨‹ï¼‰ã€‚  
**PHPæ€ç»´**ï¼šä½¿ç”¨ Redis æˆ– Memcached åšä¸­é—´å­˜å‚¨ã€‚
```python
from multiprocessing import Manager

# ğŸš€ æ¨è (Fast/Pythonic) - è¿›ç¨‹é—´å…±äº«
# åŠ¨ä½œï¼šManager å¯åŠ¨ä¸€ä¸ªç‹¬ç«‹çš„æœåŠ¡å™¨è¿›ç¨‹æ¥ç»´æŠ¤è¿™ä¸ªåˆ—è¡¨
with Manager() as manager:
    shared_list = manager.list([1, 2, 3])
    # å¯ä»¥ä¼ é€’ç»™å…¶ä»–è¿›ç¨‹ä¿®æ”¹ï¼Œæ•°æ®åŒæ­¥
    shared_list.append(4)

# ğŸ’¡ æºç çº§å‰–æ (Source Code Analysis)
# --------------------------------------------------------------------
# 1. ä»£ç†æ¨¡å¼ (Proxy):
#    - `shared_list` æœ¬åœ°åªæ˜¯ä¸€ä¸ªä»£ç†å¯¹è±¡ã€‚
#    - æ¯æ¬¡æ“ä½œï¼ˆå¦‚ appendï¼‰ï¼Œå®ƒéƒ½ä¼šé€šè¿‡ Pipe/Socket åºåˆ—åŒ–æ•°æ®ï¼Œå‘ç»™ Manager è¿›ç¨‹ã€‚
#    - Manager è¿›ç¨‹æ”¹å®Œåç¡®è®¤ã€‚
#
# 2. æ€§èƒ½æƒè¡¡ï¼š
#    - è¿™æ¯”ç›´æ¥å†…å­˜æ“ä½œæ…¢å¾ˆå¤šï¼ˆæ¶‰åŠ IPC é€šè®¯ï¼‰ã€‚
#    - ä½†è¿™æ˜¯ Python åŸç”Ÿç»•è¿‡ GIL å®ç°å¹¶è¡Œä¿®æ”¹åˆ—è¡¨çš„å”¯ä¸€æ ‡å‡†é€”å¾„ã€‚
```

#### 10. ğŸ´â€â˜ ï¸ é»‘å®¢ï¼šç»§æ‰¿Â listÂ çš„é™·é˜± (UserList)

**åœºæ™¯**ï¼šä½ æƒ³é€ ä¸€ä¸ªä¼šè‡ªåŠ¨æ‰“å°æ—¥å¿—çš„åˆ—è¡¨ã€‚  
**PHPæ€ç»´**ï¼šç»§æ‰¿Â ArrayObjectã€‚
```python
# âŒ é”™è¯¯åšæ³•ï¼šç›´æ¥ç»§æ‰¿ list
class MyList(list):
    def __setitem__(self, index, value):
        print("Setting...")
        super().__setitem__(index, value)

# é—®é¢˜ï¼š
# l = MyList([1, 2])
# l.extend([3, 4]) -> è¿™å¯èƒ½ä¸ä¼šè§¦å‘ä½ çš„ __setitem__ï¼
# å› ä¸º CPython å†…éƒ¨çš„ C æ–¹æ³• (extend) é€šå¸¸ç›´æ¥è°ƒç”¨åº•å±‚çš„ C APIï¼Œè·³è¿‡ Python å±‚é¢çš„é‡è½½ã€‚

# ğŸš€ æ¨è (Fast/Pythonic)
from collections import UserList
class SafeList(UserList):
    # UserList å†…éƒ¨æŒæœ‰ä¸€ä¸ª self.data åˆ—è¡¨
    # æ‰€æœ‰çš„æ“ä½œéƒ½ä¼šå¼ºåˆ¶èµ° Python æ–¹æ³•ï¼Œç¡®ä¿ä½ èƒ½æ‹¦æˆªåˆ°ã€‚
    pass
```