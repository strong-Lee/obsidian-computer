```json
《应用设计蓝图》
版本：1.1
更新日期：2025年9月24日
核心目标：围绕小型瑜伽室教练的日常工作流和学员日常工作流，重构并定义核心功能、交互模式与视觉语言。

1. 常识问题

1.1 课程的规则

教练开设了8个基础课程：基础普拉提、心肺功能提示、普拉提、运动损伤康复、基础塑形、孕产私教、产后修复。一般直接把几个基础课程进行一个打包（俗称卡）来出售，例如有个学员购买了年卡，这个年卡会包含基础普拉提、普拉提、心肺功能等。教练排课的时候比如排普拉提，学员的年卡包含普拉提，只要在有效期内就可以预约本节课。卡包一般分为：年卡、半年卡、季卡、月卡、次卡（也叫私教卡）。在一般情况下次卡属于1个教练1个学员的课程，其它为1个教练多个学员的课程。也有特殊情况比如给某个学员赠送了3节课，就会给她单独开一个3次卡。

1.2 课程状态的规则

一般有常规课和试听课，教练的课程状态：已完成（教练上课、学员上课），已请假（教练有事没上课），补课（针对请假后来单补的课程），未开始，
学员的课程状态：已预约，未预约，已到课，缺席（预约未到场），补签（未预约但到场）。教练和学员的课程状态是交集并行的。

学员只能预约今天的课程，人少，教练或者学员有时候会请假，一般都是当前预约。

2. 顶层信息架构
应用的底部 Tab Bar 结构定义如下，此为最高优先级，不可更改。
- [ 首页 ] - Home: 面向学员的C端展示。
- [ 日程 ] - Schedule: (原“工作台”) 教练或学员处理所有核心事务的B端入口。
- [ 我的 ] - My: 个人账户与设置。

[首页] Tab 对应的页面
温馨提示：展示角色48小时内最近一堂训练课的倒计时和课程名称，底部有一个导航按钮方便用户打开手机地图APP进行导航。
本月数据：
	- 学员角色：汇总本月的上课次数、请假次数、消耗多少卡路里。
	- 教练角色：汇总学员总数、营收金额、新签学员、本月耗课
代办事宜：以ICON的实现展示“我要约课”、“教练团队”、“课程推荐”、“个人中心”的入口。
我的健康旅程：学员购买的课程简略信息：课程名称和简述。

近48小时内有课程展示“温馨提示”，否则展示“本月数据”。
    
[日程] Tab 对应的页面。
教练角色：其页面大标题为“工作台 (Workbench)”，内部包含两大功能区：
	a. 日常操作 (Daily Ops):高频、即时的核心业务操作。
	b. 工作室管理 (Studio Settings): 低频、基础的后台设置。
学员角色：其页面大标题为“周课表 (calendar week)”，主要功能显示学员本周内所有可以预约的课程，一周七天，每天的数据占一行，点击课程后可以进入“我要预约”课程页面。

[我的] Tab 对应的页面
顶部展示区：用户头像、角色名称、入驻天数；点击可编辑用户基本信息；
功能区：我的消息、修改密码、意见反馈、关于我们；
底部区：联系我们、退出登录


3. 学员角色功能模块详述

3.1 学员档案

顶部仪表盘：头像、姓名、性别、训练时长、会员标签、温馨短语等等
内容区：
	tab1： 我的卡包（默认）
	以卡片列表形式展示该学员拥有的所有卡包；
    每个卡片清晰展示：卡名、剩余课时/天数、有效期、关联课程、合同号；
    卡片上应有状态标签（如“使用者”、“已过期”）；
    tab2： 全部记录
    将上课记录、试听记录、请假记录合并为一个统一的时间轴；
    时间轴上今年的日期只显示月日就可以，非今年的日期需要显示年月日；
    上课记录和试听记录显示：课程名称、时间、教练、状态、场馆；
    请假记录显示：请假总天数、状态、时间段、请假事由、课程是否顺延；
    每一条记录前用不同的小图标或标签来区分类型（例如：一个瑜伽垫图标代表上课，一个飞机图标代表请假）。


4. 教练角色功能模块详述

4.1 课表视图(日常操作模块)
日课表、周课表
默认展示 [ 日课表 ]，下方是当天课程的时间轴列表，每个课程都是一个遵循设计系统规范的 Card。卡片上清晰展示核心信息：时间、课程名称、状态（如 进行中、即将开始）、预约人数/最大人数（如 8/10）。
4.1.1 关键交互
a. 教练在“课表视图”中点击任意一节课的卡片。
b. 进入“课程管理面板 (Class Management Panel)”页面。此页面是所有课中、课前、课后操作的聚合点。
c. “课程管理面板”布局
	- 顶部摘要区 (Header)：课程名称、时间、教练、教室、预约状态等信息。
	- 学员名单区 (Roster)：这是整合的核心
		以列表形式展示所有 **已预约** 的学员。
	    每位学员一行，包含：头像、姓名、状态标签（默认：已预约）。
	    学员名单的右上方，有一个醒目的主操作按钮 [ + 添加学员 ]。这个按钮统一了“协助约课”和“补签”的入口。
	- 交互逻辑：
		课前点击 [ + 添加学员 ]：等同于“协助约课”。弹窗让教练从学员列表中搜索并添加，添加后该学员状态变为已预约。
	    课中/课后点击 [ + 添加学员 ]：等同于“补签”。流程相同，但添加后学员状态直接变为已到课。
		状态切换：对于列表中 已预约 的学员，教练可以直接点击其条目，触发状态切换：已到课 -> 迟到 -> 缺席。
		取消预约：长按某个已经预约的学员可以取消其预约。
		撤销签到：已经上过的课，可以将误操作标记为已到课的学员更改为缺席。
	    批量操作：在底部提供一个 [ 一键签到 ] 按钮，将所有 已预约 学员标记为 已到课，以处理大部分学员都到齐的场景。

4.2 学员管理（日常操作模块）
管理所有学员档案的入口。进入后是学员列表，可以搜索、新增学员，并查看学员详情（卡包、上课记录等）。
学员详情页面：
顶部摘要区：头像、姓名、性别等
内容区：
	tab1： 我的卡包（默认）
	以卡片列表形式展示该学员拥有的所有卡包；
    每个卡片清晰展示：卡名、剩余课时/天数、有效期、关联课程；
    卡片上应有状态标签（如“使用中”、“已过期”）；
    “长按结束此卡”的交互非常棒，予以保留。
    tab2： 全部记录（老师角色应该拆分、不应合并统一）
    将上课记录、试听记录、请假记录合并为一个统一的时间轴；
    每一条记录前用不同的小图标或标签来区分类型（例如：一个瑜伽垫图标代表上课，一个飞机图标代表请假）。

学员请假、调整卡的次数或者时间（延期）、卡上完了需要关闭，学员请假回来要复课

[办理请假] 不应只是一个简单的表单，而应该是一个“学员请假管理面板”，因为它包含“请假”和“销假”两种状态。这个面板应该清晰地展示：
- 当前状态：
- 正常上课中
- 请假中 (有效期已冻结)
- 历史记录：
    - 一个简洁的列表，展示该学员所有的历史请假记录。
        
【操作一】办理请假 (Initiate Leave)

如果学员当前是“正常上课中”，面板上会有一个主操作按钮 [+ 新增请假]。点击后，弹出一个配置窗口或进入一个表单页，包含以下字段：

1. 请假时间段 (Date Range):
    - 开始日期 和 结束日期。这是必填项。系统应自动计算出总天数。   
2. 影响的卡包 (Affected Cards):
    - 系统应自动列出该学员所有 “使用中” 的 计天卡 (如年卡、季卡、月卡)。
    - 旁边有一个总开关 [✔] 卡包有效期顺延，默认勾选。
    - 勾选时 (默认): 系统会提示：“以下卡包的有效期将自动顺延 XX 天。”        
    - 不勾选时: 适用于学员自愿放弃延期的情况。系统应有二次确认：“确定不为该学员顺延卡包有效期吗？”    
    - 注意：计次卡（如私教10次卡）通常不受请假影响，因为它们没有严格的连续有效期，除非工作室有特殊规定（如：次卡也必须在N个月内用完）。系统应能智能区分，默认只处理计天卡。
3. 请假事由 (Reason):
    - 一个简单的文本框，选填。用于记录，如“出差”、“生病”等。    
4. 确认提交
    
【操作二】办理销假 (Resume Class)
如果学员当前是“请假中”，面板的主操作按钮应变为 [办理销假 (复课)]。当学员提前回来或请假期满后，教练点击此按钮。
- 场景一：提前销假
    - 点击 [办理销假] 后，系统弹窗确认：“确定要为 [学员姓名] 办理销假吗？她的课程将从今天起恢复正常，剩余的假期将作废。”
    - 确认后，系统执行：
        - 更新该条请假记录的实际结束日期为“今天”。
        - 重新计算并更新 相关卡包的有效期。例如，原计划请30天，顺延了30天；现在只请了10天，系统需要把多顺延的20天减回去。这是最关键的业务逻辑，必须保证计算准确！
        - 恢复学员的预约资格。
        - 学员详情页的状态标签恢复为“正常”。
- 场景二：假期正常结束
    - 系统应该有一个 每日的定时任务 (Daily Cron Job)。在凌晨自动扫描所有请假记录，如果某学员的 end_date 是“昨天”，系统会自动为她办理销假，恢复其预约资格。这样可以减少教练手动操作的负担。

4.3 快速售卡（日常操作模块）
将原先深藏在学员管理的“绑定卡”功能提炼出来，重命名为更贴近业务的“快速售卡”。点击后，流程是：选择学员 -> 选择卡包模板 -> 配置实例 (卡包名称/次数/价格) -> 完成售卖。这是一个清晰的价值创造流程。

4.4 我的请假（日常操作模块）
教练请假是一个独立且重要的操作，应有独立的入口。流程清晰：选择请假日期 -> 关联影响的课程 -> 提交


4.5 课程与卡包（工作室管理模块）
入口页: 一个包含两个标签页的页面：[ 课程库 ] [ 卡包模板 ]
课程库 Tab：
布局: 一个课程列表。显示“课程名称”和“课程时长”。右下角有一个 [ + 新建课程 ] 按钮
功能: 点击列表项进入“编辑课程页”；点击 + 进入“新建课程页”。
卡包模板 Tab：
布局: 一个卡包列表。每行显示“卡包名称”、“价格”、“有效期”。右上角有 [ + 新建卡包 ] 按钮。
功能: 点击列表项进入“编辑卡包页”；点击 + 进入“新建卡包页”。
新建/编辑课程页 (表单页):
    - 布局: 包含字段：课程名称、课程时长 (分钟)、课程简介、封面图上传等。
新建/编辑卡包页 (表单页):
    - 布局: 包含字段：卡包名称、售卖价格、总次数/总天数、有效期(天)。最关键的是，下方有一个“关联课程”的多选列表，让您可以勾选这个卡包适用于哪些“课程库”中的课程，每个课程每次消耗几节课时。

4.6 排课模板（工作室管理模块）
入口页 (列表页):
    - 布局: 一个“模板”列表。每行显示模板名称，如“Bay的每周一、四流小班课”。右下角有悬浮按钮 [ + 新建模板 + 我要排课 ] 。
	- 列表功能1: 点击新建模板，教练可输入模板名称、选择课程（从“课程”里选）、选择教室（从“教室”里选）、选择教练（从“教练”里选）、最大预约人数、选择时间（给出自定义弹框，教练可以多次添加周几、几点开始、课时，例如 周一 18:00开始 50分钟； 周四 18:00 50分钟；课时的选择一般从30～120分钟，10分钟一个区间）
    - 列表功能2: 点击列表项有一个自定义弹框，告诉教练会根据“xx”模板自动排本周课程，下面有课程的预览，周几、几点到几点、哪个教练、在哪个教室上什么课。例如：周一 10:00-11:00 哈他瑜伽 (王老师)；周二 19:00-20:00 流瑜伽 (李老师)。可选择确认和取消，确认后调用API接口自动排课，取消则关闭弹框；
    - 列表功能3: 列表页项的右侧有三个点的按钮（编辑、删除），点击编辑进入模板编辑页，对上述功能进行编辑；点击删除给弹框确定是否删除。
    - 我要排课功能1: 选择课程 (从“课程库”里选)、选择教练 (从“员工”里选)、选择教室 (从“教室”里选)、选择上课类型（常规课、试听课、补课）、选择重复时间（给出自定义弹框，教练可以多次添加周几、几点开始、课时，例如 周一 18:00开始 50分钟； 周四 18:00 50分钟；课时的选择一般从30～120分钟，10分钟一个区间）、最早预约时间、最大预约人数、如果是一节单次课，填完直接“发布”即可、如果希望这节课重复，则打开“重复设置”、结束条件：按次数（重复N次后结束），按日期（重复一直到YYYY-MM-DD 结束）

4.7 教室与员工（工作室管理模块）
入口页: 一个包含两个标签页的页面：[ 教室管理 ] [ 员工管理 ]
教室管理 Tab:
	- 布局: 教室列表。每行显示“教室名称”和“可容纳人数”。右下角悬浮 [ + 添加教室 ]。 
    - 功能: 增删改查。表单包含名称、容纳人数、环境照片上传等。
员工管理 Tab:
    - 布局: 员工列表。每行显示“员工头像”、“姓名”、“角色(教练/前台)”。右下角悬浮 [ + 添加员工 ]。
    - 功能: 增删改查。表单包含姓名、联系方式、角色、简介、头像上传等。


```